# Cargo configuration for Kreuzberg workspace
# This file configures build caching and compilation settings

[build]
# Enable incremental builds locally for faster iterations.
# CI disables sccache; set RUSTC_WRAPPER manually if you want it.
incremental = true

[target.x86_64-unknown-linux-gnu]
# Linux-specific linker settings (if needed)

[target.x86_64-apple-darwin]
# macOS x86_64 specific settings

[target.aarch64-apple-darwin]
# macOS ARM64 specific settings

[target.aarch64-unknown-linux-gnu]
# Cross-compilation for Linux ARM64
linker = "aarch64-linux-gnu-gcc"
ar = "aarch64-linux-gnu-ar"

[target.x86_64-pc-windows-msvc]
# Windows MSVC specific settings

[target.x86_64-pc-windows-gnu]
# Use MSYS2 UCRT64 toolchain for MinGW builds
# Note: These are fallback paths. Environment variables (CARGO_TARGET_X86_64_PC_WINDOWS_GNU_LINKER, TARGET_AR, etc.) take precedence
linker = "x86_64-w64-mingw32-gcc"
ar = "ar"

[target.wasm32-unknown-unknown]
rustflags = [
    "-C",
    "target-feature=+atomics,+bulk-memory",
    "-C",
    "link-arg=--shared-memory",
    "-C",
    "link-arg=--max-memory=2147483648",
    "-C",
    "link-arg=--import-memory",
    "-C",
    "link-arg=--export=__wasm_init_tls",
    "-C",
    "link-arg=--export=__tls_size",
    "-C",
    "link-arg=--export=__tls_align",
    "-C",
    "link-arg=--export=__tls_base",
]

[unstable]
build-std = ["panic_abort", "std"]

# Network settings for faster crate downloads
[net]
git-fetch-with-cli = false

# Registry settings
[registries.crates-io]
protocol = "sparse"
